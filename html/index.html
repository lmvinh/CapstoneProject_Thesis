<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ESP32 Sensor Dashboard</title>
    <style>
      html {
        font-family: Arial;
        display: inline-block;
        text-align: center;
      }
      h2 {
        font-size: 3rem;
      }
      p {
        font-size: 3rem;
      }
      body {
        max-width: 600px;
        margin: 0px auto;
        padding-bottom: 25px;
      }
      .switch {
        position: relative;
        display: inline-block;
        width: 120px;
        height: 68px;
      }
      .switch input {
        display: none;
      }
      .slider {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #f63e36;
        border-radius: 34px;
      }
      .slider:before {
        position: absolute;
        content: "";
        height: 52px;
        width: 52px;
        left: 8px;
        bottom: 8px;
        background-color: #fff;
        -webkit-transition: 0.4s;
        transition: 0.4s;
        border-radius: 68px;
      }
      input:checked + .slider {
        background-color: #3cc33c;
      }
      input:checked + .slider:before {
        -webkit-transform: translateX(52px);
        -ms-transform: translateX(52px);
        transform: translateX(52px);
      }
    </style>
  </head>
  <body>
    <div>
      <h2>Sensor Data</h2>
      <p>Temperature: <span id="temperature">--</span> Â°C</p>
      <p>Humidity: <span id="humidity">--</span> %</p>
      <p>Pressure: <span id="pressure">--</span> hPa</p>
    </div>
    <div>
      <p>%BUTTONPLACEHOLDER%</p>
      <p>%BUTTONPLACEHOLDER2%</p>
      <p>%BUTTONPLACEHOLDER3%</p>
      <p>%BUTTONPLACEHOLDER4%</p>

      <script>
        function toggleCheckbox(element) {
          var xhr = new XMLHttpRequest();
          if (element.checked) {
            xhr.open("GET", "/update?state=1", true);
          } else {
            xhr.open("GET", "/update?state=0", true);
          }
          xhr.send();
        }

        function toggleCheckbox2(element) {
          var xhr2 = new XMLHttpRequest();
          if (element.checked) {
            xhr2.open("GET", "/update?state2=1", true);
          } else {
            xhr2.open("GET", "/update?state2=0", true);
          }
          xhr2.send();
        }

        setInterval(function () {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
              var inputChecked;
              var outputStateM;

              if (this.responseText == 1) {
                inputChecked = true;
                outputStateM = "ON";
              } else {
                inputChecked = false;
                outputStateM = "OFF";
              }
              document.getElementById("output").checked = inputChecked;
              document.getElementById("outputState").innerHTML = outputStateM;
            }
          };
          xhttp.open("GET", "/state", true);
          xhttp.send();

          var xhttp2 = new XMLHttpRequest();
          xhttp2.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
              var inputChecked2;
              var outputStateM2;

              if (this.responseText == 1) {
                inputChecked2 = true;
                outputStateM2 = "ON";
              } else {
                inputChecked2 = false;
                outputStateM2 = "OFF";
              }
              document.getElementById("output2").checked = inputChecked2;
              document.getElementById("outputState2").innerHTML = outputStateM2;
            }
          };
          xhttp2.open("GET", "/state2", true);
          xhttp2.send();
        }, 1000);
      </script>
    </div>
    <script>
      function toggleCheckbox(element) {
        var xhr = new XMLHttpRequest();
        if (element.checked) {
          xhr.open("GET", "/update?state=1", true);
        } else {
          xhr.open("GET", "/update?state=0", true);
        }
        xhr.send();
      }

      function toggleCheckbox2(element) {
        var xhr2 = new XMLHttpRequest();
        if (element.checked) {
          xhr2.open("GET", "/update?state2=1", true);
        } else {
          xhr2.open("GET", "/update?state2=0", true);
        }
        xhr2.send();
      }

      setInterval(function () {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            var inputChecked;
            var outputStateM;

            if (this.responseText == 1) {
              inputChecked = true;
              outputStateM = "ON";
            } else {
              inputChecked = false;
              outputStateM = "OFF";
            }
            document.getElementById("output").checked = inputChecked;
            document.getElementById("outputState").innerHTML = outputStateM;
          }
        };
        xhttp.open("GET", "/state", true);
        xhttp.send();

        var xhttp2 = new XMLHttpRequest();
        xhttp2.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            var inputChecked2;
            var outputStateM2;

            if (this.responseText == 1) {
              inputChecked2 = true;
              outputStateM2 = "ON";
            } else {
              inputChecked2 = false;
              outputStateM2 = "OFF";
            }
            document.getElementById("output2").checked = inputChecked2;
            document.getElementById("outputState2").innerHTML = outputStateM2;
          }
        };
        xhttp2.open("GET", "/state2", true);
        xhttp2.send();
      }, 1000);
      function updateSensorData() {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "/ajax_data", true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) {
            try {
              const data = JSON.parse(xhr.responseText);
              document.getElementById("temperature").textContent =
                data.temperature.toFixed(2);
              document.getElementById("humidity").textContent =
                data.humidity.toFixed(2);
              document.getElementById("pressure").textContent =
                data.pressure.toFixed(2);
            } catch (error) {
              console.error("Failed to parse JSON data:", error);
            }
          }
        };
        xhr.send();
      }

      // Update sensor data every 5 seconds
      setInterval(updateSensorData, 5000);
    </script>
  </body>
</html>
